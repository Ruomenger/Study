# 001. Com基础知识

COM基础知识文档分为以下两部分：

- 指南
- 参考

## 1.1. 指南

### 1.1.1. COM新增功能

#### Windows 7中对COM的更改

Windows 7中对COM API进行了以下添加：

- CoGetApartmentType

Windows 7中更改了以下API：

- IGlobalOptions

#### Windows Vista中对COM的更改

在Windows Vista中对COM进行了以下更改：

- COM高度标记使使用受限用户帐户（LUA）运行的应用程序可以激活具有增强功能的COM类。 有关更多信息，请参见COM Elevation Moniker。
- 当您在Windows Vista计算机上安装进行COM调用的应用程序，并计划以管理员身份运行该应用程序时，您必须按计算机而不是按用户安装该应用程序，否则它将无法正常运行。

### 1.1.2. 组件对象模型

Microsoft组件对象模型（COM）是一个与平台无关的分布式面向对象的系统，用于创建可以交互的二进制软件组件。 COM是Microsoft的OLE（复合文档），ActiveX（支持Internet的组件）以及其他产品的基础技术。

要了解COM（以及所有基于COM的技术），必须了解它不是一种面向对象的语言，而是一种标准，这一点至关重要。 COM也没有指定应如何构建应用程序； 语言，结构和实现细节留给应用程序开发人员。 确切地说，COM指定了对象模型和编程要求，使COM对象（也称为COM组件，有时简称为对象）能够与其他对象进行交互。 这些对象可以在单个进程中，在其他进程中，甚至可以在远程计算机上。 它们可以用不同的语言编写，并且在结构上可能完全不同，这就是为什么COM被称为二进制标准的原因。 在将程序转换为二进制机器代码之后应用的标准。

对COM的唯一语言要求是，代码是用一种语言创建的，该语言可以创建指针的结构，并可以通过指针显式或隐式地调用函数。 诸如C ++和Smalltalk之类的面向对象语言提供了简化COM对象的实现的编程机制，但是诸如C，Java和VBScript之类的语言也可以用于创建和使用COM对象。

COM定义了COM对象的本质。 通常，软件对象由一组数据和操作该数据的功能组成。 COM对象是一种对象，其中通过一组或多组相关函数专门访问对象的数据。 这些函数集称为接口，而接口的函数称为方法。 此外，COM要求访问接口方法的唯一方法是通过指向接口的指针。

除了指定基本的二进制对象标准外，COM还定义了某些基本接口，这些接口提供了所有基于COM的技术所共有的功能，并且它提供了所有组件所需的少量功能。 COM还定义了对象如何在分布式环境中一起工作，并增加了安全性功能以帮助提供系统和组件的完整性。

### 1.1.3. COM技术概述

https://docs.microsoft.com/en-us/windows/win32/com/com-technical-overview